var containersFieldsMessages={containerName:"Invalid name: only letters, numbers, underscore and hyphen",hostname:"Invalid name: only letters, numbers, underscore and hyphen",apiversion:"Invalid String: Only numbers and .",working_dir:"File format path only, e.g /folder_name/folder",maxRetryCount:"Invalid Entry: Only numbers",cgroupParent:"Only letters, numbers, _ and - are allowed.",cpusetMems:"Invalid input, only numbers, - and ,.",cpusetCpus:"Invalid input, only numbers, - and ,.",memLimit:"Invalid input, only numbers and the unit letter(b,B,k,K,m,M,g,G)",memReservation:"Invalid input, only numbers and the unit letter(b,B,k,K,m,M,g,G)",memSwapLimit:"Invalid input, only numbers and the unit letter(b,B,k,K,m,M,g,G)",volumeDriver:"Only numbers, letters, _, and - are allowed.",initPath:"File format path only, e.g /folder_name/folder",ipcMode:"Only numbers, letters, _, and : are allowed",isolation:"Only numbers, letters and _ are allowed.",kernelMemory:"Invalid input, only numbers and the unit letter(b,B,k,K,m,M,g,G)",macAddress:"Invalid input, enter a valid mac address.",pidMode:"Only numbers, letters and _ are allowed.",platform:"Only numbers, letters and _ are allowed.",runtime:"Only numbers, letters and _ are allowed.",shmSize:"Invalid input, only numbers and the unit letter(b,B,k,K,m,M,g,G)",stopSignal:"Only letters, -, and _ are allowed.",user:"Only numbers, letters, _, and - are allowed.",usernsMode:"Only numbers, letters, _, and - are allowed.",utsMode:"Only numbers, letters, and  _ are allowed."};let dictionaries={labels:{},environment:{},ports:{},lxc_conf:{},healthcheck:{},extra_hosts:{},links:{},log_config:{},storage_opt:{},sysctls:{},tmpfs:{}},lists={command:[],entrypoint:[],volumes:[],volumes_from:[],mounts:[],cap_add:[],cap_drop:[],domainname:[],device_cgroup_rules:[],devices:[],device_requests:[],dns:[],dns_opt:[],dns_search:[],group_add:[],security_opt:[],ulimits:[]};function showDictModal(e){let a=dictionaries[e];showDictionaryModal(a,e)}function showLModal(e){let a=lists[e];showListModal(a,e)}function invalidParamsExists(){for(key in containersFieldsMessages)if(!document.getElementById(key).checkValidity())return document.getElementById(key).setCustomValidity(containersFieldsMessages[key]),document.getElementById(key).reportValidity(),!0;return!1}function createContainer(){if(invalidParamsExists())return void showAlert("invalid params, check red marked fields!","danger");let e=$("#chkRun")[0].checked;image=$("#selectImage")[0].value;let a=$("#containerName")[0].value;validateStrFor(a,"noinvalidchars");$("#command")[0].value,dictionaries.ports;let s=$("#hostname")[0].value,t=$("#apiversion")[0].value,r=($("#entrypoint")[0].value,$("#working_dir")[0].value),i={Name:$("#restartPolicy")[0].value,MaximumRetryCount:valueOrNull($("#maxRetryCount")[0].value,"number")},n=(dictionaries.environment,dictionaries.labels,$("#chkTty")[0].checked),l=$("#chkAutoremove")[0].checked,o=$("#chkDetach")[0].checked,m=$("#chkPublishAll")[0].checked,d=$("#chkReadOnly")[0].checked,c=$("#chkPrivileged")[0].checked,p=$("#cgroupParent")[0].value,u=$("#cpuCount")[0].value,v=$("#cpuPercent")[0].value,_=$("#cpuPeriod")[0].value,h=$("#cpuQuota")[0].value,g=$("#cpuRtPeriod")[0].value,y=$("#cpuRtRuntime")[0].value,k=$("#cpuShares")[0].value,b=$("#nanoCpus")[0].value;p=Number(p),u=Number(u),v=Number(v),_=Number(_),h=Number(h),g=Number(g),y=Number(y),k=Number(k),b=Number(b);let f=$("#cpusetMems")[0].value,w=$("#cpusetCpus")[0].value,O=$("#memLimit")[0].value,M=$("#memReservation")[0].value,S=$("#memSwappiness")[0].value,I=$("#memSwapLimit")[0].value,E=$("#blkioWeight")[0].value,x=$("#blkioWeightDevice")[0].value,R=$("#chkNetworkDisabled")[0].checked,N=$("#network")[0].value,j=$("#networkMode")[0].value,A=$("#volumeDriver")[0].value,C=($("#volumes")[0].value,$("#volumes_from")[0].value,$("#mounts")[0].value,$("#deviceReadBps")[0].value),P=$("#deviceReadIops")[0].value,B=$("#deviceWriteBps")[0].value,q=$("#deviceWriteIops")[0].value,D=($("#cap_add")[0].value,$("#cap_drop")[0].value,$("#domainname")[0].value,$("#initPath")[0].value),L=$("#ipcMode")[0].value,F=$("#isolation")[0].value,K=$("#kernelMemory")[0].value,G=$("#macAddress")[0].value,W=$("#pidMode")[0].value,z=$("#platform")[0].value,T=$("#runtime")[0].value,V=$("#shmSize")[0].value,J=$("#stopSignal")[0].value,H=$("#usernsMode")[0].value,Q=$("#user")[0].value,U=$("#utsMode")[0].value,X=($("#device_cgroup_rules")[0].value,$("#devices")[0].value,$("#device_requests")[0].value,$("#dns")[0].value,$("#dns_opt")[0].value,$("#dns_search")[0].value,$("#group_add")[0].value,$("#security_opt")[0].value,$("#ulimits")[0].value,$("#chkOomKill")[0].checked),Y=$("#chkInit")[0].checked,Z=$("#chkStdinOpen")[0].checked,ee=$("#chkStream")[0].checked,ae=$("#chkUseConfigProxy")[0].checked,se=(dictionaries.extra_hosts,dictionaries.healthcheck,dictionaries.lxc_conf,dictionaries.links,dictionaries.log_config,dictionaries.storage_opt,dictionaries.sysctls,dictionaries.tmpfs,$("#oomScoreAdj")[0].value),te=$("#pidsLimit")[0].value;params={advancedCreation:!0,run:e,image:image},a&&(params.name=a),lists.command.length>0&&(params.command=lists.command),isObjectEmpty(dictionaries.ports)||(params.ports=dictionaries.ports),s&&(params.hostname=s),t&&(params.version=t),lists.entrypoint.length>0&&(params.entrypoint=lists.entrypoint),r&&(params.working_dir=r),i&&(params.restart_policy=i),isObjectEmpty(dictionaries.environment)||(params.environment=dictionaries.environment),isObjectEmpty(dictionaries.labels)||(params.labels=dictionaries.labels),params.tty=n,params.auto_remove=l,params.detach=o,params.publish_all_ports=m,params.read_only=d,params.privileged=c,p&&(params.cgroup_parent=p),u&&(params.cpu_count=u),v&&(params.cpu_percent=v),_&&(params.cpu_period=_),h&&(params.cpu_quota=h),g&&(params.cpu_rt_period=g),y&&(params.cpu_rt_runtime=y),k&&(params.cpu_shares=k),b&&(params.nano_cpus=b),f&&(params.cpuset_mems=f),w&&(params.cpuset_cpus=w),O&&(params.mem_limit=O),M&&(params.mem_reservation=M),S&&(params.mem_swappiness=S),I&&(params.memswap_limit=I),E&&(params.blkio_weight=E),x&&(params.blkio_weight_device=x),params.network_disabled=R,R&&N&&(params.network=N),j&&(params.network_mode=j),A&&(params.volume_driver=A),lists.volumes.length>0&&(params.volumes=lists.volumes),lists.volumes_from.length>0&&(params.volumes_from=lists.volumes_from),lists.mounts.length>0&&(params.mounts=lists.mounts),C&&(params.device_read_bps=C),P&&(params.device_read_iops=P),B&&(params.device_write_bps=B),q&&(params.device_write_iops=q),lists.cap_add.length>0&&(params.cap_add=lists.cap_add),lists.cap_drop.length>0&&(params.cap_drop=lists.cap_drop),lists.domainname.length>0&&(params.domainname=lists.domainname),D&&(params.init_path=D),L&&(params.ipc_mode=L),F&&(params.isolation=F),K&&(params.kernel_memory=K),G&&(params.mac_address=G),W&&(params.pid_mode=W),z&&(params.platform=z),T&&(params.runtime=T),V&&(params.shm_size=V),J&&(params.stop_signal=J),H&&(params.userns_mode=H),Q&&(params.user=Q),U&&(params.uts_mode=U),lists.device_cgroup_rules.length>0&&(params.device_cgroup_rules=lists.device_cgroup_rules),lists.devices.length>0&&(params.devices=lists.devices),lists.device_requests.length>0&&(params.device_requests=lists.device_requests),lists.dns.length>0&&(params.dns=lists.dns),lists.dns_opt.length>0&&(params.dns_opt=lists.dns_opt),lists.dns_search.length>0&&(params.dns_search=lists.dns_search),lists.group_add.length>0&&(params.group_add=lists.group_add),lists.security_opt.length>0&&(params.security_opt=lists.security_opt),lists.ulimits.length>0&&(params.ulimits=lists.ulimits),isObjectEmpty(dictionaries.extra_hosts)||(params.extra_hosts=dictionaries.extra_hosts),isObjectEmpty(dictionaries.healthcheck)||(params.healthcheck=dictionaries.healthcheck),isObjectEmpty(dictionaries.lxc_conf)||(params.lxc_conf=dictionaries.lxc_conf),isObjectEmpty(dictionaries.links)||(params.links=dictionaries.links),isObjectEmpty(dictionaries.log_config)||(params.log_config=dictionaries.log_config),isObjectEmpty(dictionaries.storage_opt)||(params.storage_opt=dictionaries.storage_opt),isObjectEmpty(dictionaries.sysctls)||(params.sysctls=dictionaries.sysctls),isObjectEmpty(dictionaries.tmpfs)||(params.tmpfs=dictionaries.tmpfs),params.oom_kill_disable=X,params.init=Y,params.stdin_open=Z,params.stream=ee,params.use_config_proxy=ae,se&&(params.oom_score_adj=se),te&&(params.pids_limit=te);let re={type:"POST",url:"/containers/create",isAsync:!0,params:JSON.stringify(params),requestHeaders:{"Content-Type":"application/json"}};sendRequest(re,e=>console.log("loading request..."),e=>{let a=JSON.parse(e.srcElement.response);"error"in a?(showAlert("An error ocurred creating the container, check server logs.","danger"),console.log("error: ",a.error)):(showAlert("Container created succesfully","success"),location.href="/containers")},e=>{showAlert("Container failed to create","danger"),console.log("error for container creation: ",e)})}$("#chkRun").change(()=>{$("#chkRun")[0].checked?($("#chkRemove").removeAttr("disabled"),$("#chkStdout").removeAttr("disabled"),$("#chkStderr").removeAttr("disabled")):($("#chkRemove").attr("disabled",!0),$("#chkStdout").attr("disabled",!0),$("#chkStderr").attr("disabled",!0))});
